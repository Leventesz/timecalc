<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
  <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
  <link rel="stylesheet" href="lib/bootstrap/css/bootstrap.min.css" media="screen">
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <title>Time Sheet Calculator</title>
</head>

<body>
  <div class="outer-wrapper">
    <h3>Time Sheet Calculator</h3>
    <div class="table-wrapper">
      <table class="main-table table table-bordered table-hover">
          <thead>
            <tr class="header">
              <th>Time In</th>
              <th>Time Out</th>
              <th>Break</th>
              <th>Hours</th>
            </tr>
          </thead>
          <tfoot>
            <tr class="total">
              <td class="clear-button" colspan="1">
                <input type="button" class="btn-small btn" 
                       value="clear" data-bind='click:clearClick'>
              </td>
              <td></td>
              <td class="total-label">Total</td>
              <td><div class="week-total" data-bind='text:grandTotal'>0</div></td>
            </tr>
          </tfoot>
          <tbody data-bind='foreach: rows'>
            <tr class="day" data-bind='css:{error: rowTotal() < 0}'>
                <td><input class='required' 
                           data-bind='value:timeIn, click:cellClick, event:{blur:cellBlur}'></td>
                <td><input class='required' 
                           data-bind='value:timeOut, click:cellClick, event:{blur:cellBlur}'></td>
                <td><input class='number' 
                           data-bind='value:breakLen, click:cellClick, event:{blur:cellBlur}'></td>
                <td><div class="day-total" data-bind='text:rowTotal'></div></td>
            </tr>
          </tbody>
      </table>
    </div> <!-- table-wrapper -->

    <div class="instructions">
      <h4>Tips:</h4>
      <ul>
        <li><strong>Time In/Out</strong> should be time of day ("9am", "8:15p").
        <li><strong>Break</strong> should be a duration in hours (e.g. "1", "0.25").
        <li> Both tab or enter advances to the next field.
        <li> Additional rows are added automatically as necessary.
      </ul>
    </div> <!-- instructions -->
  </div> <!-- outer-wrapper -->

  <script src="lib/require-jquery.js" data-main="src/main"></script>
  <script>
    require(["timecalc", "knockout"], function(timecalc, ko) {
      /** 
      * Auto-focus on the first input.
      function focusOnFirst(doSelect) {
        // the total shows up in HTML before the days so we must
        // filter the selection
        var item = $('.day input:visible:first').first().focus();
        if (doSelect === true) {
          item.select();
        }
      }

      /**
      * "Enter" should go to the next input field like tab.
      function onEnterAdvanceFocus() {
        $("input").bind('keypress', function (event) {
          if (event.keyCode === 13) {
            var $set = $('input'),
            $next = $set.eq($set.index(this) + 1);
            $next.focus();
          }
        });
      }

      // create model and initialize
      var viewModel = new TimeSheetModel({callback: function(c) {
          ko.applyBindings(c); 
      }});
      */
      var viewModel = new timecalc.TimeSheetModel({callback: function(c) { 
        ko.applyBindings(c);
      }});
    });
  </script>
</body>
</html>
